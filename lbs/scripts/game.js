!function e(t,i,a){function n(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[r]={exports:{}};t[r][0].call(h.exports,function(e){var i=t[r][1][e];return n(i?i:e)},h,h.exports,e,t,i,a)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<a.length;r++)n(a[r]);return n}({1:[function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("states/GameState"),u=a(l),h=e("states/Preload"),c=a(h),p=e("states/Main"),g=a(p),f=function(e){function t(){n(this,t);var e=window.innerWidth,i=window.innerHeight,a=o(this,Object.getPrototypeOf(t).call(this,e,i,Phaser.AUTO,"content",null,!0));return a.state.add("GameState",u["default"],!1),a.state.add("Preload",c["default"],!1),a.state.add("Main",g["default"],!1),a.amap=new AMap.Map("map",{features:["bg","building"],zoom:18,zooms:[17,19],animateEnable:!1,rotateEnable:!0}),a.main=null,a.lPosition=null,a.deviceorientation=0,a.zoomLevel=2,a.skill={},a.player={x:e/2,y:i/2,position:null,level:1,exp:0,gold:1e3,move:0,energy:[666,666,666]},a.items=[],a.state.start("Preload"),a}return r(t,e),s(t,[{key:"updateLocation",value:function(e){var t=this;this.player.position&&(this.player.move+=e.distance(this.player.position)),this.player.position=e,(null==this.lPosition||this.lPosition.distance(e)>=250)&&!function(){t.lPosition=e;var i=t;AMap.service(["AMap.PlaceSearch"],function(){console.log("蛤！");var e=new AMap.PlaceSearch({pageSize:20,type:"生活服务|体育休闲服务|购物服务"});e.searchNearBy("",i.player.position,500,function(e,t){"complete"==e&&i.main.addPoiBuilding(t.poiList.pois,0)});var t=new AMap.PlaceSearch({pageSize:20,type:"科教文化服务|风景名胜|政府机构及社会团体"});t.searchNearBy("",i.player.position,500,function(e,t){"complete"==e&&i.main.addPoiBuilding(t.poiList.pois,1)});var a=new AMap.PlaceSearch({pageSize:20,type:"餐饮服务|医疗保健服务"});a.searchNearBy("",i.player.position,500,function(e,t){"complete"==e&&i.main.addPoiBuilding(t.poiList.pois,2)})})}()}},{key:"gpsToPixel",value:function(e,t){var i=this.amap.lngLatToContainer([e,t]);return[i.getX(),i.getY()]}},{key:"gpsDistance",value:function(e,t,i,a){var n=new AMap.LngLat(e,t);return n.distance([i,a])}},{key:"addExp",value:function(e){for(this.player.exp+=e;this.player.exp>=100;)this.player.exp-=100,this.player.level+=1}},{key:"addGold",value:function(e){this.player.gold+=e}},{key:"addItem",value:function(e,t){}}]),t}(Phaser.Game),d=new f;window.addEventListener("deviceorientation",function(e){d.amap.setRotation(e.alpha),d.deviceorientation=e.alpha}),navigator.geolocation.watchPosition(function(e){AMap.convertFrom([e.coords.longitude,e.coords.latitude],"gps",function(e,t){d.amap.panTo(t.locations[0]),d.updateLocation(t.locations[0])})},function(){console.log("geolocation error")},{enableHighAccuracy:!0})},{"states/GameState":11,"states/Main":12,"states/Preload":13}],2:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e,i,o,r,s){a(this,t);var l=e.gpsToPixel(i,o),u=n(this,Object.getPrototypeOf(t).call(this,e,l[0],l[1],"box"));return u.anchor.set(.5),u.lng=i,u.lat=o,u.radius=24,u.reward=r,u.amount=s,u.ring=u.game.make.graphics(0,0),u.ring.lineStyle(3,4886754),u.ring.drawCircle(0,0,2*u.radius),u.addChild(u.ring),u}return o(t,e),r(t,[{key:"update",value:function(){var e=this.game.gpsToPixel(this.lng,this.lat);this.x=e[0],this.y=e[1],this.scale.setTo(1/Math.pow(2,3-this.game.zoomLevel))}}]),t}(Phaser.Sprite);i["default"]=s},{}],3:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e,i,o,r,s){a(this,t);var l=e.gpsToPixel(i,o),u=n(this,Object.getPrototypeOf(t).call(this,e,l[0],l[1],"building"+r));return u.anchor.set(.5),u.lng=i,u.lat=o,u.radius=s,u.type=r,u.ring=u.game.make.graphics(0,0),0==r?u.ring.lineStyle(3,15255922):1==r?u.ring.lineStyle(3,7514344):u.ring.lineStyle(3,15233650),u.ring.drawCircle(0,0,2*u.radius),0==r?u.ring.beginFill(15462829,.25):1==r?u.ring.beginFill(11390193,.25):u.ring.beginFill(15838637,.25),u.ring.drawCircle(0,0,2*u.radius),u.addChild(u.ring),u}return o(t,e),r(t,[{key:"update",value:function(){var e=this.game.gpsToPixel(this.lng,this.lat);this.x=e[0],this.y=e[1],this.scale.setTo(1/Math.pow(2,3-this.game.zoomLevel))}}]),t}(Phaser.Sprite);i["default"]=s},{}],4:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e,i,o,r,s,l,u,h){a(this,t);var c=e.game.gpsToPixel(i,o),p=n(this,Object.getPrototypeOf(t).call(this,e.game,c[0],c[1],r));return p.anchor.set(.5),p.state=e,p.olng=i,p.olat=o,p.lng=i,p.lat=o,p.damage=u,p.range=h,p.hit=!1,p.lngS=Math.cos(p.game.math.degToRad(s+90))*l*1e-5,p.latS=Math.sin(p.game.math.degToRad(s+90))*l*1e-5,p}return o(t,e),r(t,[{key:"update",value:function(){if(this.state.monsters.forEach(function(e){this.game.math.distance(this.x,this.y,e.x,e.y)<=24&&(e.getDamage(this.damage),this.hit=!0)},this),this.hit||this.game.gpsDistance(this.olng,this.olat,this.lng,this.lat)>=this.range)return void this.destroy();this.lng+=this.lngS,this.lat+=this.latS;var e=this.game.gpsToPixel(this.lng,this.lat);this.x=e[0],this.y=e[1],this.scale.setTo(1/Math.pow(2,3-this.game.zoomLevel))}}]),t}(Phaser.Sprite);i["default"]=s},{}],5:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e){a(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,e.game,null,"hud",!0));return i.expbg=i.game.make.sprite(8,8,"expbg"),i.expbar=i.game.make.sprite(8,8,"exp"),i.expmask=i.game.make.graphics(8,8),i.expbar.mask=i.expmask,i.yicon=i.game.make.sprite(8,30,"ypower"),i.ytext=i.game.make.text(38,30,"0",{font:"16px Arial",fill:"#000000"}),i.bicon=i.game.make.sprite(78,30,"bpower"),i.btext=i.game.make.text(108,30,"0",{font:"16px Arial",fill:"#000000"}),i.ricon=i.game.make.sprite(148,30,"rpower"),i.rtext=i.game.make.text(178,30,"0",{font:"16px Arial",fill:"#000000"}),i.extra=i.game.make.group(),i.gicon=i.game.make.sprite(8,56,"gold"),i.gtext=i.game.make.text(38,60,"0",{font:"16px Arial",fill:"#000000"}),i.eicon=i.game.make.sprite(108,56,"ex"),i.etext=i.game.make.text(138,60,"0",{font:"16px Arial",fill:"#000000"}),i.moveR=i.game.make.text(8,84,"行走里程 0 m",{font:"16px Arial",fill:"#000000"}),i.addChild(i.expbg),i.addChild(i.expbar),i.addChild(i.expmask),i.addChild(i.yicon),i.addChild(i.ytext),i.addChild(i.bicon),i.addChild(i.btext),i.addChild(i.ricon),i.addChild(i.rtext),i.addChild(i.extra),i.extra.addChild(i.gicon),i.extra.addChild(i.gtext),i.extra.addChild(i.eicon),i.extra.addChild(i.etext),i.extra.addChild(i.moveR),i.extra.visible=!1,i}return o(t,e),r(t,[{key:"update",value:function(){this.expmask.clear(),this.expmask.beginFill(0),this.expmask.drawRect(0,0,208*(this.game.player.exp/100),17),this.gtext.setText(""+this.game.player.gold),this.etext.setText(""+this.game.player.level),this.moveR.setText("行走里程 "+Math.floor(this.game.player.move)+" m"),this.ytext.setText(""+Math.floor(this.game.player.energy[0])),this.btext.setText(""+Math.floor(this.game.player.energy[1])),this.rtext.setText(""+Math.floor(this.game.player.energy[2]))}}]),t}(Phaser.Group);i["default"]=s},{}],6:[function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("./SearchRing"),u=a(l),h=e("./MessageBox"),c=a(h),p=e("./Bullet"),g=a(p),f=function(e){function t(e){n(this,t);var i=o(this,Object.getPrototypeOf(t).call(this,e.game,null,"menu",!0)),a=i.game.world.centerX,r=i.game.world.width,s=i.game.world.centerY,l=i.game.world.height,h=48,c=8;return i.state=e,i.showRoad=!1,i.mainMenu=i.game.make.group(),i.searchRing=new u["default"](i.state,a,s),i.Ibag=i.game.make.button(a-2*(h+c),l-c-.5*h,"bag",function(){this.shopMenu.visible=!this.shopMenu.visible},i,0,1,0,1),i.Ibag.anchor.set(.5),i.Itask=i.game.make.button(a-h-c,l-c-.5*h,"task",function(){this.state.hud.extra.visible=!this.state.hud.extra.visible},i,0,1,0,1),i.Itask.anchor.set(.5),i.Isearch=i.game.make.button(a,l-c-.5*h,"search",i.finishSearch,i,0,1,0,1),i.Isearch.anchor.set(.5),i.Isearch.onInputDown.add(i.startSearch,i),i.Ibattle=i.game.make.button(a+(h+c),l-c-.5*h,"battle",i.toBattle,i,0,1,0,1),i.Ibattle.anchor.set(.5),i.IConfig=i.game.make.button(a+2*(h+c),l-c-.5*h,"config",function(){this.showRoad?(this.game.amap.setFeatures(["bg","building"]),this.showRoad=!1):(this.game.amap.setFeatures(["bg","road","building"]),this.showRoad=!0)},i,0,1,0,1),i.IConfig.anchor.set(.5),i.battleMenu=i.game.make.group(),i.BSkill=i.game.make.button(a-(96+1.5*c),l-c-32,"battlemenu",i.useSkill,i,0,0,0,0),i.BSkill.anchor.set(.5),i.BYellow=i.game.make.button(a-(32+.5*c),l-c-32,"battlemenu",function(){this.addSkillBall(100)},i,1,1,1,1),i.BYellow.anchor.set(.5),i.BBlue=i.game.make.button(a+(32+.5*c),l-c-32,"battlemenu",function(){this.addSkillBall(10)},i,2,2,2,2),i.BBlue.anchor.set(.5),i.BRed=i.game.make.button(a+(96+1.5*c),l-c-32,"battlemenu",function(){this.addSkillBall(1)},i,3,3,3,3),i.BRed.anchor.set(.5),i.BQuit=i.game.make.button(r-.5*h-c,c+.5*h,"battle",i.quitBattle,i,0,0,0,0),i.BQuit.anchor.set(.5),i.BSkillT=i.game.make.sprite(a-(96+1.5*c),l-c-32,"battlemenu",0),i.BSkillT.anchor.set(.5),i.skillBall=0,i.cSkill=0,i.tSkill=0,i.cd=[0,0,0,0,0,0,0,0,0,0],i.arrow=i.game.make.sprite(i.game.world.centerX,i.game.world.centerY,"arrow"),i.arrow.anchor.set(.5),i.shopMenu=i.game.make.group(),i.shop=i.game.make.sprite(a-150,s-150,"shop"),i.sItem1=i.game.make.button(a-150+20,s-150+31,"mask",i.buyY,i),i.sItem2=i.game.make.button(a-150+20,s-150+93,"mask",i.buyB,i),i.sItem3=i.game.make.button(a-150+20,s-150+155,"mask",i.buyR,i),i.sItem4=i.game.make.button(a-150+20,s-150+217,"mask",i.buyE,i),i.shopMenu.addChild(i.shop),i.shopMenu.addChild(i.sItem1),i.shopMenu.addChild(i.sItem2),i.shopMenu.addChild(i.sItem3),i.shopMenu.addChild(i.sItem4),i.shopMenu.visible=!1,i.battleMenu.addChild(i.BSkill),i.battleMenu.addChild(i.BYellow),i.battleMenu.addChild(i.BBlue),i.battleMenu.addChild(i.BRed),i.battleMenu.addChild(i.BQuit),i.battleMenu.addChild(i.BSkillT),i.battleMenu.visible=!1,i.mainMenu.addChild(i.searchRing),i.mainMenu.addChild(i.Ibag),i.mainMenu.addChild(i.Itask),i.mainMenu.addChild(i.Isearch),i.mainMenu.addChild(i.Ibattle),i.mainMenu.addChild(i.IConfig),i.addChild(i.arrow),i.addChild(i.shopMenu),i.addChild(i.battleMenu),i.addChild(i.mainMenu),i}return r(t,e),s(t,[{key:"startSearch",value:function(){this.state.boxes.forEachAlive(function(e){this.game.math.distance(e.x,e.y,this.game.player.x,this.game.player.y)<=e.radius/Math.pow(2,3-this.game.zoomLevel)&&(this.game.stage.addChild(new c["default"](this.game,e.reward,e.amount)),0==e.reward?this.game.addExp(e.amount):1==e.reward&&this.game.addGold(e.amount),this.game.time.events.add(3e3,function(){this.alive=!1,this.visible=!1},e).timer.start())},this),this.state.boxes.visible=!0,this.searchRing.startSearch()}},{key:"finishSearch",value:function(){this.state.boxes.visible=!1,this.searchRing.finishSearch()}},{key:"toBattle",value:function(){this.mainMenu.visible=!1,this.battleMenu.visible=!0}},{key:"quitBattle",value:function(){this.mainMenu.visible=!0,this.battleMenu.visible=!1}},{key:"addSkillBall",value:function(e){this.tSkill+=e,this.skillBall+=1,3==this.skillBall&&(this.cSkill=this.tSkill,this.tSkill=0,this.skillBall=0,this.BSkillT.loadTexture(this.game.skill[this.cSkill].img))}},{key:"useSkill",value:function(){var e=this.game.skill[this.cSkill],t=this.game.player.energy;this.cSkill>0&&0==this.cd[e.index]&&t[0]>=e.cost[0]&&t[1]>=e.cost[1]&&t[2]>=e.cost[2]&&(this.cd[e.index]=e.cd,t[0]-=e.cost[0],t[1]-=e.cost[1],t[2]-=e.cost[2],this.state.bullets.addChild(new g["default"](this.state,this.game.player.position.getLng(),this.game.player.position.getLat(),e.img,this.game.deviceorientation,e.speed,e.damage,e.range)))}},{key:"buyY",value:function(){this.game.player.gold>=100&&(this.game.player.gold-=100,this.game.player.energy[0]+=100)}},{key:"buyB",value:function(){this.game.player.gold>=100&&(this.game.player.gold-=100,this.game.player.energy[1]+=100)}},{key:"buyR",value:function(){this.game.player.gold>=100&&(this.game.player.gold-=100,this.game.player.energy[2]+=100)}},{key:"buyE",value:function(){this.game.player.gold>=100&&(this.game.player.gold-=100,this.game.addExp(50))}},{key:"update",value:function(){this.searchRing.update();for(var e=0;e<this.cd.length;e++)this.cd[e]>0&&(this.cd[e]-=1)}}]),t}(Phaser.Group);i["default"]=f},{"./Bullet":4,"./MessageBox":7,"./SearchRing":10}],7:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(e){function t(e,i,o){a(this,t);var r=n(this,Object.getPrototypeOf(t).call(this,e,e.world.centerX,96,"messagebox"));return r.anchor.set(.5),r.msgItem=r.game.make.sprite(-114,0,"item"+i),r.msgItem.anchor.set(.5),r.msgHeader=r.game.make.text(-76,-20,"探索宝箱获得:",{font:"16px Arial",fill:"#ffffff"}),r.msgContent=r.game.make.text(-76,0,r.game.items[i].title+" x "+o,{font:"16px Arial",fill:"#ffffff"}),r.addChild(r.msgItem),r.addChild(r.msgHeader),r.addChild(r.msgContent),r.game.time.events.add(5e3,function(){this.destroy()},r).timer.start(),r}return o(t,e),t}(Phaser.Sprite);i["default"]=r},{}],8:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e,i,o,r){a(this,t);var s=e.gpsToPixel(i,o),l=n(this,Object.getPrototypeOf(t).call(this,e,s[0],s[1],"m"+r));return l.anchor.set(.5),l.lng=i,l.lat=o,l.hp=10,l}return o(t,e),r(t,[{key:"getDamage",value:function(e){this.hp-=e,this.hp<=0&&(this.game.addExp(15),this.destroy())}},{key:"update",value:function(){var e=this.game.gpsToPixel(this.lng,this.lat);this.x=e[0],this.y=e[1],this.scale.setTo(1/Math.pow(2,3-this.game.zoomLevel))}}]),t}(Phaser.Sprite);i["default"]=s},{}],9:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e,i,o,r){a(this,t);var s=n(this,Object.getPrototypeOf(t).call(this,e,i,o,r,{font:"45px Arial",fill:"#ff0044",align:"center"}));return s._speed=125,s._colorIndex=0,s._colors=["#ee4035","#f37736","#fdf498","#7bc043","#0392cf"],s.colorize(),s.startTimer(),s.game.stage.addChild(s),s}return o(t,e),r(t,[{key:"startTimer",value:function(){this.game.time.events.loop(this._speed,this.colorize,this).timer.start()}},{key:"colorize",value:function(){for(var e=0;e<this.text.length;e++)this._colorIndex===this._colors.length&&(this._colorIndex=0),this.addColor(this._colors[this._colorIndex],e),this._colorIndex++}}]),t}(Phaser.Text);i["default"]=s},{}],10:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(e,i,o){a(this,t);var r=n(this,Object.getPrototypeOf(t).call(this,e.game,i,o));return r.state=e,r._radius=0,r._speed=1,r._linestyle={width:3,color:15891851},r.visible=!1,r.maskRing=e.game.make.graphics(0,0),r.addChild(r.maskRing),r}return o(t,e),r(t,[{key:"startSearch",value:function(){console.log("Start Search"),this.visible=!0}},{key:"finishSearch",value:function(){console.log("Finish Search"),this.clear(),this.maskRing.clear(),this._radius=0,this.visible=!1}},{key:"update",value:function(){this.visible&&(this.game.player.energy[1]>=.05?(this.clear(),this.lineStyle(this._linestyle.width,this._linestyle.color),this.drawCircle(0,0,this._radius),this.maskRing.clear(),this.maskRing.beginFill(0),this.maskRing.drawCircle(0,0,this._radius),this._radius+=this._speed*Math.pow(2,this.game.zoomLevel),this.game.player.energy[1]-=.05):this.finishSearch())}}]),t}(Phaser.Graphics);i["default"]=s},{}],11:[function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("objects/RainbowText"),u=a(l),h=function(e){function t(){return n(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return r(t,e),s(t,[{key:"create",value:function(){var e={x:this.game.world.centerX,y:this.game.world.centerY},t=new u["default"](this.game,e.x,e.y,"- phaser -\nwith a sprinkle of\nES6 dust!");t.anchor.set(.5)}}]),t}(Phaser.State);i["default"]=h},{"objects/RainbowText":9}],12:[function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("objects/HUD"),u=a(l),h=e("objects/Menu"),c=a(h),p=e("objects/Box"),g=a(p),f=e("objects/Building"),d=a(f),m=e("objects/Monster"),b=a(m),y=function(e){function t(){return n(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return r(t,e),s(t,[{key:"create",value:function(){this.game.main=this,this.game.items=this.game.cache.getJSON("items"),this.boxesJson=this.game.cache.getJSON("boxes"),this.game.skill=this.game.cache.getJSON("skill"),this.buildingsJson=this.game.cache.getJSON("buildings"),this.monstersJson=this.game.cache.getJSON("monsters"),this.sDis=-1,this.menu=new c["default"](this),this.hud=new u["default"](this),this.buildings=this.game.add.group(),this.poiBuildY=this.game.add.group(),this.poiBuildB=this.game.add.group(),this.poiBuildR=this.game.add.group(),this.boxes=this.game.add.group(),this.boxes.mask=this.menu.searchRing.maskRing,this.boxes.visible=!1,this.bullets=this.game.add.group(),this.monsters=this.game.add.group();for(var e=0;e<this.buildingsJson.length;e++){var t=this.buildingsJson[e];this.buildings.addChild(new d["default"](this.game,t.position[0],t.position[1],t.type,t.radius))}for(var i=0;i<this.boxesJson.length;i++){var a=this.boxesJson[i];this.boxes.addChild(new g["default"](this.game,a.position[0],a.position[1],a.reward,a.amount))}for(var n=0;n<this.monstersJson.length;n++){var o=this.monstersJson[n];this.monsters.addChild(new b["default"](this.game,o.position[0],o.position[1],o.type))}}},{key:"update",value:function(){var e=this.game.input.pointer1,t=this.game.input.pointer2;e.isDown&&t.isDown?this.sDis<0?this.sDis=this.game.math.distance(e.worldX,e.worldY,t.worldX,t.worldY):this.game.math.distance(e.worldX,e.worldY,t.worldX,t.worldY)<this.sDis-48?(this.game.amap.zoomOut(),this.game.zoomLevel>1&&(this.game.zoomLevel-=1),this.sDis=-1):this.game.math.distance(e.worldX,e.worldY,t.worldX,t.worldY)>this.sDis+48&&(this.game.amap.zoomIn(),this.game.zoomLevel<3&&(this.game.zoomLevel+=1),this.sDis=-1):this.sDis=-1;var i=[!1,!1,!1];this.buildings.forEach(function(e){this.game.math.distance(e.x,e.y,this.game.player.x,this.game.player.y)<=e.radius/Math.pow(2,3-this.game.zoomLevel)&&(i[e.type]=!0)},this),this.poiBuildY.forEach(function(e){this.game.math.distance(e.x,e.y,this.game.player.x,this.game.player.y)<=e.radius/Math.pow(2,3-this.game.zoomLevel)&&(i[e.type]=!0)},this),this.poiBuildB.forEach(function(e){this.game.math.distance(e.x,e.y,this.game.player.x,this.game.player.y)<=e.radius/Math.pow(2,3-this.game.zoomLevel)&&(i[e.type]=!0)},this),this.poiBuildR.forEach(function(e){this.game.math.distance(e.x,e.y,this.game.player.x,this.game.player.y)<=e.radius/Math.pow(2,3-this.game.zoomLevel)&&(i[e.type]=!0)},this),i[0]&&(this.game.player.energy[0]+=.05),i[1]&&(this.game.player.energy[1]+=.05),i[2]&&(this.game.player.energy[2]+=.05)}},{key:"addPoiBuilding",value:function(e,t){if(0==t){this.poiBuildY.removeAll(!0,!0);for(var i=0;i<e.length;i++){var a=e[i];this.poiBuildY.addChild(new d["default"](this.game,a.location.getLng(),a.location.getLat(),t,72))}}else if(1==t){this.poiBuildB.removeAll(!0,!0);for(var n=0;n<e.length;n++){var o=e[n];this.poiBuildB.addChild(new d["default"](this.game,o.location.getLng(),o.location.getLat(),t,72))}}else{this.poiBuildR.removeAll(!0,!0);for(var r=0;r<e.length;r++){var s=e[r];this.poiBuildR.addChild(new d["default"](this.game,s.location.getLng(),s.location.getLat(),t,72))}}}}]),t}(Phaser.State);i["default"]=y},{"objects/Box":2,"objects/Building":3,"objects/HUD":5,"objects/Menu":6,"objects/Monster":8}],13:[function(e,t,i){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(e){function t(){return a(this,t),n(this,Object.getPrototypeOf(t).apply(this,arguments))}return o(t,e),r(t,[{key:"preload",value:function(){this.game.add.text(80,150,"loading...",{font:"30px Courier",fill:"#fff"});this.game.load.image("boiler-logo","imgs/boilerplate-logo.png"),this.game.load.image("arrow","imgs/arrow.png"),this.game.load.image("box","imgs/box.png"),this.game.load.image("messagebox","imgs/messagebox.png"),this.game.load.image("item0","imgs/item0.png"),this.game.load.image("item1","imgs/item1.png"),this.game.load.image("gold","imgs/gold.png"),this.game.load.image("ex","imgs/ex.png"),this.game.load.image("exp","imgs/exp.png"),this.game.load.image("expbg","imgs/expbg.png"),this.game.load.image("ypower","imgs/ypower.png"),this.game.load.image("bpower","imgs/bpower.png"),this.game.load.image("rpower","imgs/rpower.png"),this.game.load.image("shop","imgs/shop.png"),this.game.load.image("mask","imgs/mask.png"),this.game.load.image("b0","imgs/b0.png"),this.game.load.image("b1","imgs/b1.png"),this.game.load.image("b2","imgs/b2.png"),this.game.load.image("b3","imgs/b3.png"),this.game.load.image("m0","imgs/m0.png"),this.game.load.image("m1","imgs/m1.png"),this.game.load.image("m2","imgs/m2.png"),this.game.load.image("m3","imgs/m3.png"),this.game.load.image("m4","imgs/m4.png"),this.game.load.image("building0","imgs/building0.png"),this.game.load.image("building1","imgs/building1.png"),this.game.load.image("building2","imgs/building2.png"),this.game.load.spritesheet("search","imgs/searchbtn.png",48,48),this.game.load.spritesheet("bag","imgs/bagbtn.png",48,48),this.game.load.spritesheet("battle","imgs/battlebtn.png",48,48),this.game.load.spritesheet("task","imgs/taskbtn.png",48,48),this.game.load.spritesheet("config","imgs/configbtn.png",48,48),
this.game.load.spritesheet("battlemenu","imgs/battleMenu.png",64,64),this.game.load.json("items","json/item.json"),this.game.load.json("boxes","json/boxes.json"),this.game.load.json("skill","json/skill.json"),this.game.load.json("buildings","json/buildings.json"),this.game.load.json("monsters","json/monsters.json")}},{key:"create",value:function(){this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.EXACT_FIT,this.game.state.start("Main")}}]),t}(Phaser.State);i["default"]=s},{}]},{},[1]);